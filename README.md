Code mostly generated with ChatGPT
